!function(){var __hasProp={}.hasOwnProperty,__extends=function(t,r){function e(){this.constructor=t}for(var o in r)__hasProp.call(r,o)&&(t[o]=r[o]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};!function t(r,e,o){function n(a,c){if(!e[a]){if(!r[a]){var s="function"==typeof require&&require;if(!c&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var p=e[a]={exports:{}};r[a][0].call(p.exports,function(t){var e=r[a][1][t];return n(e?e:t)},p,p.exports,t,r,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(t,r){var e,o;o=t("./MacroSet"),e=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,t),r.prototype.install=function(t){r.__super__.install.call(this,t),this.addMacro("reference",this.macroReference),this.addMacro("events",this.macroEvents),this.addMacro("component",this.macroComponent),this.addMacro("baseCls",this.macroBaseCls)},r.prototype.macroReference=function(t){return'html:miwo-reference="'+t+'"'},r.prototype.macroEvents=function(t){return t=t.replace(/([a-zA-Z0-9]+):'?([a-zA-Z0-9]+)'?/g,"$1:\\'$2\\'"),'html:miwo-events="{'+t+'}"'},r.prototype.macroComponent=function(t){return"html:<div miwo-component=\"'+ (typeof "+t+'!="undefined" && Type.isObject('+t+") ? "+t+'.name : "'+t+'") +\'"></div>'},r.prototype.macroBaseCls=function(t){return'string:me.getBaseCls("'+t+'")'},r}(o),r.exports=e},{"./MacroSet":7}],2:[function(t,r){var e,o;o=t("./MacroSet"),e=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,t),r.prototype.install=function(t){r.__super__.install.call(this,t),this.addMacro("if",this.macroIf,this.macroEnd),this.addMacro("elseif",this.macroElseIf),this.addMacro("else",this.macroElse),this.addMacro("ifset",this.macroIfSet),this.addMacro("elseifset",this.macroElseIfSet),this.addMacro("for",this.macroFor,this.macroEnd),this.addMacro("js",this.macroJs),this.addMacro("log",this.macroLog),this.addMacro("=",this.macroWrite),this.addMacro("_",this.macroTranslate)},r.prototype.macroEnd=function(){return"}"},r.prototype.macroIf=function(t){return"if("+t+") {"},r.prototype.macroElseIf=function(t){return"} else if("+t+") {"},r.prototype.macroElse=function(){return"} else {"},r.prototype.macroIfSet=function(t){return this.macroIf("("+t+") !== undefined && ("+t+") !== null)")},r.prototype.macroElseIfSet=function(t){return this.macroElseIf("("+t+") !== undefined && ("+t+") !== null)")},r.prototype.macroFor=function(t){var r,e,o,n,i;return(e=t.match(/([\S]+)\s+in\s+([\S]+)/))?(o=e[1],n=e[2],"for(var _i=0,_l="+n+".length; _i<_l; _i++) { var "+o+" = "+n+"[_i];"):(e=t.match(/([\S]+),\s*([\S]+)\s+in\s+([\S]+)/))?(o=e[1],r=e[2],n=e[3],"for(var "+r+"=0,"+r+"_l="+n+".length; "+r+"<"+r+"_l; "+r+"++) { var "+o+" = "+n+"["+r+"];"):(e=t.match(/([\S]+),\s*([\S]+)\s+of\s+([\S]+)/))?(o=e[1],i=e[2],n=e[3],"for(var "+o+" in "+n+") { var "+i+" = "+n+"["+o+"];"):"for("+t+") {"},r.prototype.macroWrite=function(t){return"string:"+t},r.prototype.macroJs=function(t){return t+";"},r.prototype.macroLog=function(t){return"console.log("+t+");"},r.prototype.macroTranslate=function(t){var r,e;return r=t.match(/([\S]+)(\s+(.*))?/),e="",r?(e='"'===r[1].charAt(0)?"string:miwo.tr("+r[1]+")":'string:miwo.tr("'+r[1]+'")',r[3]&&(e+=".substitute({"+r[3].replace("\\","").replace("\\","")+"})"),e):e},r}(o),r.exports=e},{"./MacroSet":7}],3:[function(t,r){var e,o,n;n=t("./LatteFactory"),e=t("./LatteCompiler"),o=function(r){function o(){return o.__super__.constructor.apply(this,arguments)}return __extends(o,r),o.prototype.init=function(){this.setConfig({macros:{core:t("./CoreMacroSet"),component:t("./ComponentMacroSet")}})},o.prototype.build=function(t){t.define("latteFactory",n,function(){return function(){}}(this)),t.define("latteCompiler",e,function(t){return function(r){var e,o,n,i;i=t.config.macros;for(n in i)o=i[n],e=new o,e.install(r)}}(this)),t.define("templateRendererFactory",n).setFactory(function(){return function(){return t.get("latteFactory")}}(this))},o}(Miwo.di.InjectorExtension),r.exports=o},{"./ComponentMacroSet":1,"./CoreMacroSet":2,"./LatteCompiler":5,"./LatteFactory":6}],4:[function(require,module,exports){var Latte;Latte=function(){function Latte(t){this.compiler=t,this.filters={}}return Latte.prototype.source=null,Latte.prototype.compiled=null,Latte.prototype.filters=null,Latte.prototype.compiler=null,Latte.prototype.setFilter=function(t,r){this.filters[t]=r},Latte.prototype.setSource=function(t){this.source=t},Latte.prototype.render=function(t){var r;if(!this.compiled)try{this.compiled=this.compiler.compile(this,this.source)}catch(e){r=e,console.error("Latte compile error:",r.stack," in compiling template:\n\n",this.source),this.compiled=null}return this.compiled?this.evaluate(this.compiled,t):"LATTE_ERROR"},Latte.prototype.evaluate=function(string,params){var e,filters,name,template,_tpl;try{_tpl="",filters=this.filters,template=this;for(name in params)eval("var "+name+' = params["'+name+'"];');return eval(string)||_tpl}catch(_error){return e=_error,console.error("Latte render error:",e.stack," in template:\n\n",string),""}},Latte}(),module.exports=Latte},{}],5:[function(t,r){var e;e=function(){function t(){}return t.prototype.macros={},t.prototype.addMacro=function(t,r){return this.macros[t]=r,this},t.prototype.addMacros=function(t){var r,e;for(e in t)r=t[e],this.addMacro(e,r);return this},t.prototype.compile=function(t,r){var e,o;return e="",o=this.beforeCompile(r),e+=this.start(),e+=o.replace(/\{([^\}]+)\}/g,function(t){return function(r,o){return e=t.compileCode(o),e!==!1?e:o}}(this)),e+=this.end(),e=this.afterCompile(e)},t.prototype.start=function(){return"var _tpl = '"},t.prototype.end=function(){return"';"},t.prototype.compileCode=function(t){var r,e,o,n;return o=t.match(/^(\/)?(\S+)\s?(.*)$/),e=o[1],n=o[2],r=o[3],r=r.replace("&gt;",">"),r=r.replace("&lt;",">"),r&&(r=r.replace(/([^\|]+)\|(.+)/g,function(){return function(t,r,e){var n,i,a,c,s;for(n=r,s=e.split("|"),a=0,c=s.length;c>a;a++)i=s[a],o=i.match(/([^:]+)(:(.*))?/),n="filters."+o[1]+"("+n+(o[3]?","+o[3]:"")+")";return n}}(this))),this.writeMacro(n,r,e)},t.prototype.beforeCompile=function(t){return t=t.replace(/'/g,"\\'"),t=t.replace(/\n/g,""),t=t.replace(/\r/g,""),t=t.replace(/\{\*.*\*\}/g,"")},t.prototype.afterCompile=function(t){return t=t.replace(/>\s+</g,"> <"),t=t.replace(/>\s+\';/g,">';"),t=t.replace(/(_tpl\+?=')\s+/g,"$1"),t=t.replace(/_tpl\+=\'\s*\';/g,"")},t.prototype.writeMacro=function(t,r,e){var o,n;if(!this.macros[t])throw new Error("Undefined macro "+t);return n=this.macros[t],o="",o=e?n.nodeClosed(t,r):n.nodeOpened(t,r),this.writeCode(o)},t.prototype.writeCode=function(t){var r,e,o;return(e=t.match(/(string|js|html):(.*)/))?(o=e[1],r=e[2]):(o="js",r=t),this.write(o,r)},t.prototype.write=function(t,r){var e;if(!r)return"";switch(t){case"string":e="'+"+r+"+'";break;case"js":e="'; "+r+" _tpl+='";break;case"html":e=r}return e},t}(),r.exports=e},{}],6:[function(t,r){var e,o;e=t("./Latte"),o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return __extends(r,t),r.prototype.latteCompiler=r.inject("latteCompiler"),r.prototype.create=function(){return new e(this.latteCompiler)},r}(Miwo.Object),r.exports=o},{"./Latte":4}],7:[function(t,r){var e;e=function(){function t(){}return t.prototype.macros={},t.prototype.compiler=null,t.prototype.install=function(t){this.compiler=t},t.prototype.addMacro=function(t,r,e){this.macros[t]=[r,e],this.compiler.addMacro(t,this)},t.prototype.start=function(){},t.prototype.end=function(){},t.prototype.nodeOpened=function(t,r){return this.macros[t][0](r)},t.prototype.nodeClosed=function(t,r){return this.macros[t][1](r)},t}(),r.exports=e},{}],8:[function(t){Miwo.latte={MacroSet:t("./MacroSet"),LatteCompiler:t("./LatteCompiler"),LatteFactory:t("./LatteFactory")},miwo.registerExtension("miwo-latte",t("./DiExtension"))},{"./DiExtension":3,"./LatteCompiler":5,"./LatteFactory":6,"./MacroSet":7}]},{},[8])}();